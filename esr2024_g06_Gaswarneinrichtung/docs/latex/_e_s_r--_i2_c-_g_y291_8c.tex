\doxysection{C\+:/\+Users/\+Fabian/\+One\+Drive/\+Dokumente/4. Semester/\+Embedded Systems/\+Projekt/esr2024\+\_\+g06\+\_\+\+Gaswarneinrichtung/esr2024\+\_\+g06\+\_\+\+Gaswarneinrichtung/src/class/\+ESR-\/-\/\+I2\+C-\/\+GY291.c File Reference}
\hypertarget{_e_s_r--_i2_c-_g_y291_8c}{}\label{_e_s_r--_i2_c-_g_y291_8c}\index{C:/Users/Fabian/OneDrive/Dokumente/4. Semester/Embedded Systems/Projekt/esr2024\_g06\_Gaswarneinrichtung/esr2024\_g06\_Gaswarneinrichtung/src/class/ESR-\/-\/I2C-\/GY291.c@{C:/Users/Fabian/OneDrive/Dokumente/4. Semester/Embedded Systems/Projekt/esr2024\_g06\_Gaswarneinrichtung/esr2024\_g06\_Gaswarneinrichtung/src/class/ESR-\/-\/I2C-\/GY291.c}}


Project main-\/file\+: Requesting multiple data from ADXL345 acceleration sensor.  


{\ttfamily \#include "{}driverlib.\+h"{}}\newline
{\ttfamily \#include "{}Board.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsensor_data__t}{sensor\+Data\+\_\+t}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{_e_s_r--_i2_c-_g_y291_8c_ae2f0ff6faf548539a21b93a034e278e8}{SLAVE\+\_\+\+ADDRESS}}~0x53
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_abb16bfdd33b9d2ea4f8d121f54e3e6b8}\label{_e_s_r--_i2_c-_g_y291_8c_abb16bfdd33b9d2ea4f8d121f54e3e6b8} 
\#define {\bfseries CS\+\_\+\+SMCLK\+\_\+\+DESIRED\+\_\+\+FREQUENCY\+\_\+\+IN\+\_\+\+KHZ}~1000
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_aadaa11d9acd1cd658f32638079eafed6}\label{_e_s_r--_i2_c-_g_y291_8c_aadaa11d9acd1cd658f32638079eafed6} 
\#define {\bfseries CS\+\_\+\+SMCLK\+\_\+\+FLLREF\+\_\+\+RATIO}~30
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_a74629e9d185ce9f03694dc7fec491426}\label{_e_s_r--_i2_c-_g_y291_8c_a74629e9d185ce9f03694dc7fec491426} 
void {\bfseries Init\+MSP430\+Peripherals} (void)
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_a6434978f143ab5df2078aa566f8b471d}\label{_e_s_r--_i2_c-_g_y291_8c_a6434978f143ab5df2078aa566f8b471d} 
void {\bfseries EUSCI\+\_\+\+B\+\_\+\+I2\+C\+\_\+master\+Set\+Byte\+Cnt} (uint16\+\_\+t base\+Address, uint16\+\_\+t cnt)
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_a7e079a344043d62a2070aaea81c7ba95}\label{_e_s_r--_i2_c-_g_y291_8c_a7e079a344043d62a2070aaea81c7ba95} 
void {\bfseries gy291\+\_\+main} (void)
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_a600430c0372d4ed0b67dfd6cb63d4560}\label{_e_s_r--_i2_c-_g_y291_8c_a600430c0372d4ed0b67dfd6cb63d4560} 
void {\bfseries USCIB0\+\_\+\+ISR} (void)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_af8e307cff800aa2b078247099ea0556d}\label{_e_s_r--_i2_c-_g_y291_8c_af8e307cff800aa2b078247099ea0556d} 
\mbox{\hyperlink{structsensor_data__t}{sensor\+Data\+\_\+t}} {\bfseries gi\+\_\+sensor\+Data}
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_acd201cffe1be34905473abdd055f597f}\label{_e_s_r--_i2_c-_g_y291_8c_acd201cffe1be34905473abdd055f597f} 
uint8\+\_\+t \texorpdfstring{$\ast$}{*} {\bfseries gp\+\_\+rx\+Data}
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_a6b9d9b35a456a80a76a03f10144386e6}\label{_e_s_r--_i2_c-_g_y291_8c_a6b9d9b35a456a80a76a03f10144386e6} 
uint8\+\_\+t {\bfseries tx\+Arr} \mbox{[}32\mbox{]}
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_a502fcbcd0d6cf1e897195543ad2a5b2a}\label{_e_s_r--_i2_c-_g_y291_8c_a502fcbcd0d6cf1e897195543ad2a5b2a} 
uint8\+\_\+t \texorpdfstring{$\ast$}{*} {\bfseries gp\+\_\+tx\+Data}
\item 
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_ae1b1fbaa6eeefdd077a0f7f327c3dfcc}\label{_e_s_r--_i2_c-_g_y291_8c_ae1b1fbaa6eeefdd077a0f7f327c3dfcc} 
uint16\+\_\+t {\bfseries rxcounter} = 0
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Project main-\/file\+: Requesting multiple data from ADXL345 acceleration sensor. 

\begin{DoxyAuthor}{Author}
Sven Steddin 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2019-\/06-\/18
\end{DoxyDate}
This project has been derived from TI sample code projects MSP430ware v\+:3.\+80.\+07.\+00 (2019-\/06-\/15)\+:
\begin{DoxyItemize}
\item eusci\+\_\+b\+\_\+i2c\+\_\+ex3\+\_\+master\+Tx\+Multiple
\item eusci\+\_\+b\+\_\+i2c\+\_\+ex1\+\_\+master\+Rx\+Multiple 
\end{DoxyItemize}

\doxysubsection{Macro Definition Documentation}
\Hypertarget{_e_s_r--_i2_c-_g_y291_8c_ae2f0ff6faf548539a21b93a034e278e8}\index{ESR-\/-\/I2C-\/GY291.c@{ESR-\/-\/I2C-\/GY291.c}!SLAVE\_ADDRESS@{SLAVE\_ADDRESS}}
\index{SLAVE\_ADDRESS@{SLAVE\_ADDRESS}!ESR-\/-\/I2C-\/GY291.c@{ESR-\/-\/I2C-\/GY291.c}}
\doxysubsubsection{\texorpdfstring{SLAVE\_ADDRESS}{SLAVE\_ADDRESS}}
{\footnotesize\ttfamily \label{_e_s_r--_i2_c-_g_y291_8c_ae2f0ff6faf548539a21b93a034e278e8} 
\#define SLAVE\+\_\+\+ADDRESS~0x53}

This example shows how to configure the I2C module as a master for multiple byte transmission and reception in order to configure control registers and to read sensor data of a ADXL345 acceleration sensor on a GY291 sensor board.

The example has been modified to run an a MSP430\+FR2355 Launchpad. The example uses Ti Driverlib functions, which is supplemented by a function to make use of the transmission byte counter of the MSP430\+FR2355

Purpose\+:
\begin{DoxyItemize}
\item Modify control registers of ADXL345 in order to switch it from standby to measurement mode (see datasheet)
\item Repeatedly read samples of sensory data in x-\/, y-\/ and z-\/direction
\end{DoxyItemize}

Intended use\+:
\begin{DoxyEnumerate}
\item Connect ADXL sensor board to MSP430\+FR2355 according to the diagram below
\item Read sensor data from array sensor\+Data in debug mode
\end{DoxyEnumerate}

Description\+: The USCI\+\_\+\+B0 unit is used to read and write data to an I2C slave in interrupt mode. The byte counter function of the USCI\+\_\+\+B0 is used to generate a stop condition. The byte counter is loaded prior to the start of the transmission and decremented automatically on each byte which is sent or received. Write and read operations are implemented by interrupt service routines.

Pullup-\/resistors are already installed on the sensor board GY291, thus no external pullup resistors are required. The Launchpad drives the GY291 power supply I2\+C-\/\+Address of GY291\+: 0x53 ACLK = n/a, MCLK = SMCLK = BRCLK = DCO = \texorpdfstring{$\sim$}{\string~}1\+MHz \begin{DoxyVerb}                           /|\  /|\
          MSP430FR2355     4,7k 4,7k  GY291 - ADXL345
          Launchpad         |    |    sensorboard
        -----------------   |    |   ------------
       |     P1.2/UCB0SDA|<-|----+->|SDA         |
       |                 |  |       |            |
       |                 |  |       |            |
       |     P1.3/UCB0SCL|<-+------>|SCL         |
       |                 |          |            |
       |                 |          |            |
       |             Vcc |--------->|Vcc (3,3V)  |
       |             GND |--------->|GND         |
\end{DoxyVerb}
 Warning\+: Example program only covers the happy path of coding; no error cases are regarded

written by S. Steddin (2019-\/06-\/18) 